@page "/login"
@inherits LoginPage
@layout HeadlessLayout

<MudGrid Spacing="0" Style="height: 100vh; width: 100vw; margin: 0;">

    @* --- LADO ESQUERDO: Visual / Branding --- *@
    <MudHidden Breakpoint="Breakpoint.Xs">
        @* Usamos classes do MudBlazor (d-flex, etc) para limpar o style inline *@
        <MudItem sm="5" md="6" lg="7"
                 Class="d-flex flex-column justify-center align-center relative"
                 Style="background: linear-gradient(135deg, var(--mud-palette-secondary) 0%, var(--mud-palette-primary-darken) 150%); 
                    overflow: hidden;">

            @* Padrão de fundo (Pattern) - Agora mais sutil e elegante *@
            <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
                    background-image: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px); 
                    background-size: 30px 30px; 
                    opacity: 0.6;"></div>

            @* Conteúdo Centralizado *@
            <div class="d-flex flex-column align-center z-10 animate-fade-in">
            
                @* Avatar com anel sutil *@
                <MudAvatar Style="height: 160px; width: 160px; border: 4px solid rgba(255,255,255,0.2);" 
                           Class="elevation-8 mb-6 bg-white">
                    <MudImage Src="imgs/icon.jpg" Alt="Logo Rommanel" ObjectFit="ObjectFit.Cover" />
                </MudAvatar>

                @* Título com sombra de texto suave para leitura *@
                <MudText Typo="Typo.h3" 
                         Align="Align.Center"
                         Style="color: white; font-weight: 700; letter-spacing: 0.15em; text-transform: uppercase; text-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                    Luciana Rommanel
                </MudText>
            
                <MudText Typo="Typo.h6" 
                         Align="Align.Center"
                         Style="color: rgba(255,255,255,0.9); font-weight: 300; letter-spacing: 0.05em; margin-top: 8px;">
                    Onde sua beleza encontra o brilho perfeito!
                </MudText>
            </div>

        </MudItem>
    </MudHidden>

    @* --- LADO DIREITO: Formulário --- *@
    <MudItem xs="12" sm="7" md="6" lg="5"
             Class="d-flex align-center justify-center pa-8"
             Style="background-color: var(--mud-palette-surface);">

        <div style="width: 100%; max-width: 400px;">

            @* Cabeçalho Mobile *@
            <MudHidden Breakpoint="Breakpoint.SmAndUp">
                <div class="d-flex justify-center mb-8">
                    <MudAvatar Size="Size.Large" Color="Color.Secondary" Variant="Variant.Filled">
                        <MudIcon Icon="@Icons.Material.Filled.Diamond" />
                    </MudAvatar>
                </div>
            </MudHidden>

            <MudText Typo="Typo.h4" Class="mb-2" Color="Color.Primary" Style="font-weight: 700;">
                Bem-vinda
            </MudText>
            <MudText Typo="Typo.body1" Class="mb-8 mud-text-secondary">
                Insira suas credenciais para acessar o painel.
            </MudText>

            <EditForm Model="@InputModel" OnValidSubmit="OnValidSubmitAsync">
                <DataAnnotationsValidator />

                <MudStack Spacing="4">

                    <MudTextField Label="E-mail Corporativo"
                                  @bind-Value="InputModel.Email"
                                  For="@(() => InputModel.Email)"
                                  Variant="Variant.Text"
                                  Adornment="Adornment.Start"
                                  AdornmentIcon="@Icons.Material.Outlined.AlternateEmail"
                                  Class="mb-2"/>

                    <MudTextField Label="Senha"
                                  @bind-Value="InputModel.Password"
                                  For="@(() => InputModel.Password)"
                                  Variant="Variant.Text"
                                  InputType="@_passwordInputType"
                                  Adornment="Adornment.End"
                                  AdornmentIcon="@_passwordInputIcon"
                                  OnAdornmentClick="TogglePasswordVisibility"/>

                    <div class="d-flex justify-space-between align-center mt-2">
                        <MudCheckBox T="bool" Color="Color.Primary" Dense="true" Label="Lembrar-me" />
                        <MudLink Href="/esqueci-senha" Color="Color.Secondary" Underline="Underline.Hover">
                            Esqueceu?
                        </MudLink>
                    </div>

                    <MudButton ButtonType="ButtonType.Submit"
                               Variant="Variant.Filled"
                               Color="Color.Primary"
                               Size="Size.Large"
                               FullWidth="true"
                               Disabled="@IsBusy"
                               Class="py-3 mt-6 rounded-0 elevation-0"
                               Style="font-weight: 700; letter-spacing: 1px;">
                        @if (IsBusy)
                        {
                        <MudProgressCircular Class="ms-n1" Size="Size.Small" Indeterminate="true" Color="Color.Surface"/>
                        <MudText Class="ms-2">ACESSANDO...</MudText>
                        }
                        else
                        {
                        <MudText>ENTRAR NA LOJA</MudText>
                        }
                    </MudButton>

                </MudStack>
            </EditForm>

            <MudDivider Class="my-8"/>

            @* --- Link para Cadastro --- *@
            <MudText Align="Align.Center" Typo="Typo.body2" Class="mud-text-secondary">
                Ainda não tem acesso?
            </MudText>

            <div class="d-flex justify-center mt-2 mb-6">
                <MudButton Href="/registro"
                           Variant="Variant.Text"
                           Color="Color.Secondary"
                           Style="font-weight: 700;">
                    CRIAR NOVA CONTA
                </MudButton>
            </div>

            @* Copyright *@
            <MudText Align="Align.Center" Typo="Typo.caption" Class="mud-text-secondary">
                © 2025 LuShop - Revendedora Rommanel
            </MudText>
        </div>
    </MudItem>
</MudGrid>

@code {
bool _passwordVisibility;
InputType _passwordInputType = InputType.Password;
string _passwordInputIcon = Icons.Material.Outlined.VisibilityOff;

void TogglePasswordVisibility()
{
@if (_passwordVisibility)
{
_passwordVisibility = false;
_passwordInputIcon = Icons.Material.Outlined.VisibilityOff;
_passwordInputType = InputType.Password;
}
else
{
_passwordVisibility = true;
_passwordInputIcon = Icons.Material.Outlined.Visibility;
_passwordInputType = InputType.Text;
}
}
}